# MWE (Z01) {#z01}

```{r 'Z01', include=FALSE, cache=FALSE}
sys.source(paste0(.z$RX, "A99Knitr", ".R"), envir = knitr::knit_global())
sys.source(paste0(.z$RX, "000Packages", ".R"), envir = knitr::knit_global())
sys.source(paste0(.z$RX, "A00AllUDF", ".R"), envir = knitr::knit_global())
#invisible(lapply(f_getPathR(A09isPrime), knitr::read_chunk))
```

## Overview

- Minimum Working Examples (MWE) for the most common /interesting /obscure 'how to do in R'.
  - It does not cover any function extensively or their finer points, cautions etc.
  - It assumes that reader knows R basics.

- [How to Limit the Knit or Build](#limit-knit-z01 "z01")
- [How to Load Packages](#loadpkg-z01 "z01")
- [How to Copy Clipboard as Tibble](#load-data-z01 "z01")
- [How to provide Absolute Path or Relative Path](#load-data-z01 "z01")
- [How to Generate correlated vectors of normal distribution](#cor-vec-z01 "z01")
- [How to Count Unique Values in ALL Columns](#n-uniq-z01 "z01")
- [How to Rename ALL Headers to Proper Names](#rename-z01 "z01")
- [How to Merge Factor Levels](#merge-factor-level-z01 "z01")
- [How to Create a Contingency Table](#table-z01 "z01")
- [How to Add Rows and Column Totals to a Table or Confusion Matrix](#tab-sum-z01 "z01")
- [How to Check R Version](#version-z01 "z01")
- [How to Pipe the Subset](#pipe-sub-z01 "z01")
- [How to Test Background Colours](#bg-color-z01 "z01")

## Limit the Knit or Build {#limit-knit-z01 .tabset .tabset-fade}

```{r 'Z01-Limit-Knit-Build', eval=FALSE}
# #To only evaluate up to this chunk and complete the knit process.
knit_exit()
```

## Load Multiple Packages {#loadpkg-z01 .tabset .tabset-fade}

### Packages {.unlisted .unnumbered}

```{r 'Z01-LoadPackages', eval=FALSE}
if(FALSE) {# Install Missing Packages: Error in library(...) : there is no package called '...'
 install.packages("conflicted", dependencies = TRUE)
}

if(FALSE) {# #Load Packages that were already installed
  library("conflicted")
  #library("readr") #read_csv
  library("readxl") #read_excel
  library("dplyr")  #select
  library("tibble") #tibble
  library("tidyr")  #pivot_longer
  library("caret")  #createDataPartition
  library("ROSE")   #ovun.sample
  library("broom")  #augment
  library("stargazer")     #stargazer
  library("car")    #vif
  library("rpart")  #rpart
  library("randomForest")  #randomForest
  
  # Precedence
  # dplyr::filter | stats::filter
  conflict_prefer("filter", "dplyr")
}
```

### ALL {.unlisted .unnumbered}

```{r 'Z01-LoadPackagesALL', eval=FALSE}
if(FALSE) {# #Load Packages that were already installed
  # #Install Packages if: Error in library(...) : there is no package called '...'
  # #WARNING: Installation may take some time.
  #install.packages("dplyr", dependencies = TRUE)
  pkg <- c("dplyr", "readr", "tibble")
  lapply(pkg, FUN = function(x) {suppressMessages(library(x, character.only = TRUE))})
  rm(pkg)
}
```

## Load Data {#load-data-z01}

### Clipboard {.unlisted .unnumbered}

```{r 'Z01-LoadClipBoard', eval=FALSE}
if(FALSE) {
  library(readr)
}
# #Assuming that the Data has been copied to clipboard. Output is a Tibble.
ii <- read_delim(clipboard())
```

### PATH {.unlisted .unnumbered}

```{r 'Z01-PATH'}
# #[3] Conditions: A:Console, B: Manual R Markdown Chunk, C: Knit
loc_src <- "B09_xx_data.rds"
#
if(file.exists(paste0("./data/", loc_src))){
  # #Does not give Warning. However, it does not work during Manual Chunk evaluation i.e. AC not B
  file.exists(paste0("./data/", loc_src))
} else { #Works i.e. ABC but Warning with knitr::include_graphics()
  # #...It is highly recommended to use relative paths for images. You had absolute paths:
  file.exists(here("data", loc_src))
  file.exists(paste0(.z$XL, loc_src))
}
```

```{r 'Z01-Images', eval=FALSE}
# #Images 
loc_png <- paste0("./images/", "B38P01", "-Churn-Train-ROC", ".png")
if(FALSE){#Include images
  if(file.exists(loc_png)) include_graphics(loc_png) else include_graphics(here(loc_png))
}
if(FALSE){#Generate images
  if(!file.exists(here(loc_png))) {
    png(filename = here(loc_png))
    }
}
```


## Generate Correlated Vectors {#cor-vec-z01 .tabset .tabset-fade}

```{r 'Z01-CorrelatedVectors'}
# #Set Seed
set.seed(3)
#
# #Generate correlated vectors of normal distribution
ii <- rnorm(n = 50, mean = 0, sd = 1)
jj <- ii + rnorm(n = 50, mean = 1, sd = 0.1)
#
# #Check Correlation
cor(ii, jj)
```

## Count Unique Values in ALL Columns {#n-uniq-z01 .tabset .tabset-fade}

```{r 'Z01-CountUnique'}
# #Count Unique Values in ALL Columns
sapply(mtcars, function(x) length(unique(x)))
```

## Rename ALL Headers to Proper Names {#rename-z01 .tabset .tabset-fade}

```{r 'Z01-RenameHeaders'}
if(FALSE) {
  library(dplyr)
}
# #Rename to Proper Names | To Lower, Replace by Underscore | 
aa <- tibble("A_Underscore" = 1, "B.Dot" = 2, "C Space" = 3, "D-Dash" = 4, `E'apostrophe` = 5) #'
bb <- aa %>% rename_with(make.names) %>% 
  rename_with(~ tolower(gsub(".", "_", .x, fixed = TRUE))) 
```

## Merge Factor Levels {#merge-factor-level-z01 .tabset .tabset-fade}

- Refer [abc ](#ref-merge-factor-c34 "c34")


```{r 'Z01-Merge-Factor-Levels'}
# #Alphabetical sorting by default i.e. No = 1, Yes = 2 but we want Yes = 1, No = 2
# #"H" should be converted to NA
bb <- tibble(x = factor(c("Y", "Yes", "Y", "N", "No", "H", NA)))
bb$x
#
ii <- bb %>% mutate(across(x, factor, levels = c("Y", "Yes", "N", "No"), 
                           labels = c("Yes", "Yes", "No", "No"))) 
ii$x
```

## Create a Contingency Table {#table-z01 .tabset .tabset-fade}

```{r 'Z01-Table'}
# #Contingency Table
aa <- c("TP_A" = 3, "FP_B" = 13, "TN_C" = 7, "TN_D" = 17) #c(3, 13, 7, 17)
bb <- as.table(matrix(aa, ncol = 2, byrow = TRUE, 
                dimnames = list("Prediction" = c("Yes", "No"), "Reference" = c("Yes", "No"))))
bb
```


## Add Rows and Column Totals to a Table or Confusion Matrix {#tab-sum-z01 .tabset .tabset-fade}

```{r 'Z01-Table-Total-Rows-Column'}
# #Add Row & Column using Magrittr Pipe
ii <- bb %>% as_tibble() %>% 
  pivot_wider(names_from = Reference, values_from = n) %>% 
  rename(Prediction_Reference = 1) %>% 
  add_row(summarise(., across(1, ~"Total")), summarise(., across(where(is.numeric), sum))) %>% 
  mutate(SUM = rowSums(across(where(is.numeric))))
#
# #Add Row & Column using Base Pipe
jj <- bb |> as_tibble() |> 
  pivot_wider(names_from = Reference, values_from = n) |> 
  rename(Prediction_Reference = 1) |> 
  {\(x) add_row(x, summarise(x, across(1, ~"Total")), 
                summarise(x, across(where(is.numeric), sum)))}() |> 
  mutate(SUM = rowSums(across(where(is.numeric))))
stopifnot(identical(ii, jj))
jj
```


## Check R Version {#version-z01 .tabset .tabset-fade}

```{r 'Z01-R-Version'}
# #Version 4 has introduced Pipe "|>" in R.
R.version.string

if(TRUE) stopifnot(4L <= as.integer(R.version$major))
```

## Pipe the Subset {#pipe-sub-z01 .tabset .tabset-fade}

```{r 'Z01-Pipe-Subset'}
set.seed(3)
ii <- setNames(sample.int(n = 100, size = 10), nm = letters[1:10])
ii
# #Subset Numbers greater than 50
jj <- ii %>% `[`(. > 50)
kk <- ii |> {\(x) x[x > 50]}()
stopifnot(identical(jj, kk))
kk
```

## Test Background Colours {#bg-color-z01 .tabset .tabset-fade}

```{r 'Z01-BG-Colour-Models', collapse=FALSE, class.output="models"}
print("Models: Color= #80A080, background-color: #303030")
```

```{r 'Z01-BG-Warn-Red', collapse=FALSE, class.output="redwarn"}
tryCatch(warning("WARNING: background-color: #CF6679FF (Red)"), 
         warning = function(w) {
           print(trimws(gsub("[^:]*:(.*)", "\\1", paste0(w))))
           #suppressWarnings() #Double Arrow Assignment
           }
         )
```


## Validation {.unlisted .unnumbered .tabset .tabset-fade}

```{r 'Z01-Cleanup', include=FALSE, cache=FALSE}
f_rmExist(aa, bb, ii, jj, kk, ll)
```

```{r 'Z01-Validation', include=FALSE, cache=FALSE}
# #SUMMARISED Packages and Objects (BOOK CHECK)
f_()
#
difftime(Sys.time(), k_start)
```

****
